/*!
 *  BMWUSA 
 *  Name: dealer-map 
 * 
 */!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],executeModules=data[2],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()();return deferredModules.push.apply(deferredModules,executeModules||[]),checkDeferredModules()}function checkDeferredModules(){for(var result,i=0;i<deferredModules.length;i++){for(var deferredModule=deferredModules[i],fulfilled=!0,j=1;j<deferredModule.length;j++){var depId=deferredModule[j];0!==installedChunks[depId]&&(fulfilled=!1)}fulfilled&&(deferredModules.splice(i--,1),result=__webpack_require__(__webpack_require__.s=deferredModule[0]))}return result}var installedModules={},installedChunks={24:0},deferredModules=[];function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/etc/designs/bmwusa/bmwusa-clientlibs/";var jsonpArray=window.webpackJsonp=window.webpackJsonp||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push([19,0]),checkDeferredModules()}({"./frontend_src/bmwlib/utility/ellipse.js":function(module,exports,__webpack_require__){"use strict";var _defineProperty2=__webpack_require__("./node_modules/@babel/runtime/helpers/interopRequireDefault.js")(__webpack_require__("./node_modules/@babel/runtime/helpers/defineProperty.js"));Object.defineProperty(exports,"__esModule",{value:!0}),exports.Ellipse=void 0;exports.Ellipse=class Ellipse{constructor(config){(0,_defineProperty2.default)(this,"getCount",()=>{const browserSize=window.innerWidth;for(let i=0;i<this.BPs.length;i++){const width=this.BPs[i];if("max"!==width&&browserSize<width)return i;if("max"===width)return i;if(i===this.BPs.length)return this.BPs.length}}),this.config=config,this.BPs=config.map(bp=>bp.width)}ellipse(copy){const getBPSize=this.getCount(),val=this.config[getBPSize].count;return copy.length>val?copy.substring(0,val)+"...":copy}}},"./frontend_src/components/dealer-map/js/dealer-map.js":function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Breakpoints$current,_component=__webpack_require__("./frontend_src/bmwlib/component.js"),_ellipse=__webpack_require__("./frontend_src/bmwlib/utility/ellipse.js"),_cssVarsPonyfillConfig=_interopRequireDefault(__webpack_require__("./frontend_src/bmwlib/utility/aem/css-vars-ponyfill-config.js")),_breakpoints=_interopRequireDefault(__webpack_require__("./frontend_src/bmwlib/utility/breakpoints.js"));var _default=new _component.Component({el:".dealer-map",name:"dealer-map Component",baseStr:"dealer-map",subscriptions:{"dealer.detail-new-search":"displayNewSearch","dealer.detail-veiw-mobile":"toggleDealerDetailMobile","dealer.detail-veiw":"changeBackBtn","dealer.toggleListView":"toggleListView","dealermap.component-embedded":"embeddedComponent","dealermap.dealer-view":"displayDetailedView","dealermap.list-update":"displayResults","dealermap.no-results":"noResults","dealermap.search-results":"displayResults","dealermap.search":"hideResults","filterlist.clear-filter":"filterClear","window.resizeEnd":"resizeEvt"},maxSize:_breakpoints.default.getValue("sm","max"),isPhone:"sm"===(null===(_Breakpoints$current=_breakpoints.default.current())||void 0===_Breakpoints$current?void 0:_Breakpoints$current.breakpoint),currentFilter:0,searchTermVal:"",paginationH:0,isIPHONE:/(iPhone)/g.test(navigator.userAgent),beforeInit(){this.ellipse=new _ellipse.Ellipse([{count:28,width:768},{count:18,width:960},{count:16,width:1280},{count:25,width:"max"}]),this.trapFocus,this.outterShell=_component.$dom.qs(this.el+"__outter-shell",this.element),this.innerFill=this.element.querySelectorAll(this.el+"__inner-fill"),this.backSearchBtn=this.element.querySelector(this.el+"__top-nav-back-search"),this.filterBtn=this.element.querySelector(this.el+"__filter"),this.searchTerm=this.backSearchBtn.querySelector("span"),this.backResultsBtn=this.element.querySelector(this.el+"__top-nav-back-results"),this.newSearchBtn=this.element.querySelector(this.el+"__top-nav-new-search"),this.mapHolder=this.element.querySelector(".google-map"),this.content=this.element.querySelector(this.el+"__content-holder"),this.closeBtn=this.element.querySelector(".globalnav-map-popup__close-btn"),this.closeMap=this.closeMap.bind(this),this.hideResults=this.hideResults.bind(this),this.backToResults=this.backToResults.bind(this),this.filterDropDownToggle=this.filterDropDownToggle.bind(this),this.resetEllipse=this.resetEllipse.bind(this),this.closeFilterDropDown=this.closeFilterDropDown.bind(this),this.isEmbedded=this.element.parentNode.classList.contains("standalone-dealer-map"),this.subscriptionTokens=[],this.subscriptionTokens.push(PubSub.subscribe("map.close-modal",this.filterActiveState.bind(this))),this.subscriptionTokens.push(PubSub.subscribe("filterview.filter",this.filterActiveState.bind(this))),this.subscriptionTokens.push(PubSub.subscribe("dealermap.search",this.hideResults.bind(this)))},init(){this.element.addEventListener("click",this.checkClick),this.newSearchBtn.addEventListener("click",()=>{PubSub.publish("dealermap.search",!0)}),this.backSearchBtn.addEventListener("click",()=>{PubSub.publish("dealermap.search",!0),PubSub.publish("filter.reset-list-view"),PubSub.publish("map.set-trap-focus")}),this.backResultsBtn.addEventListener("click",this.backToResults),this.filterBtn.addEventListener("click",this.filterDropDownToggle),this.getViewportHeightMobile();for(let i=0;i<this.innerFill.length;i++)this.innerFill[i].addEventListener("click",this.closeFilterDropDown);this.isEmbedded&&PubSub.publish("dealermap.component-embedded")},getViewportHeightMobile(){_breakpoints.default.isMobile()&&(0,_cssVarsPonyfillConfig.default)(this.isIPHONE)},checkClick(e){PubSub.publish("dealer.outside.click",e)},embeddedComponent(){this.isEmbedded?PubSub.publish("dealermap.search",!0):this.element.parentNode.removeChild(this.element),PubSub.publish("bmw-grid.recalculate")},closeMap(){PubSub.publish("map.close-map"),this.innerFill&&this.toggleInnerFill()},closeFilterDropDown(){PubSub.publish("filter.toggleDisplay",!1),this.toggleInnerFill()},toggleInnerFill(show=!1){const activeStr=this.baseStr+"__inner-fill--active";for(let i=0;i<this.innerFill.length;i++)show?this.innerFill[i].classList.add(activeStr):this.innerFill[i].classList.remove(activeStr)},backToResults(e){PubSub.publish("dealer.search-results-list",e),this.toggleResultsBtn(),this.toggleFilterBtn(!0),this.toggleSearchBtn(!0),PubSub.publish("map.remove-trap-focus","detail")},resetEllipse(){this.searchTermVal&&0<this.searchTermVal.length&&(this.searchTerm.innerHTML=this.setDisplayString(this.searchTermVal))},setDisplayString(val){return`&ldquo;${this.ellipse.ellipse(val)}&rdquo;`},displayResults(e,data){this.searchTermVal=data.Term,this.currentSearch=data.currentSearch,this.searchTerm.innerHTML=this.searchTermVal&&"latLonSearch"!=data.currentSearch?this.setDisplayString(this.searchTermVal):"","singleDealer"==this.currentSearch?this.toggleResultsView(!0,!0):(this.toggleResultsView(!0,data.newSearch),this.toggleFilterBtn(!0),this.toggleActiveBorder(!0),this.toggleSearchView())},displayDetailedView(e,data){this.toggleSearchView(),this.toggleActiveBorder(!0),this.toggleResultsView(!0,data.newSearch)},displayNewSearch(){this.toggleSearchBtn(),this.toggleNewSearchBtn(!0)},filterDropDownToggle(e){const elem=e.currentTarget,activeStr=this.baseStr+"__filter--active";elem.classList.contains(activeStr)&&0==this.currentFilter?(this.filterActiveState(null),PubSub.publish("filter.toggleDisplay",!1)):(this.filterActiveState(null,!0),PubSub.publish("filter.toggleDisplay",!0))},filterActiveState(e,show=!1){const activeClass=this.baseStr+"__filter--active";"object"==typeof show&&(this.currentFilter=show.filterId,show=show.open),show||0<this.currentFilter?this.filterBtn.classList.add(activeClass):this.filterBtn.classList.remove(activeClass),this.toggleInnerFill(show)},filterClear(){const activeClass=this.baseStr+"__filter--active";this.filterBtn.classList.remove(activeClass),this.currentFilter=0,this.toggleInnerFill()},toggleResultsView(show=!1,newSearch=!1){const activeClass=this.baseStr+"-results--active";this.resultsHolder||(this.resultsHolder=this.element.querySelector(this.el+"-results")),show?(this.currentView="results",this.resultsHolder.classList.add(activeClass),newSearch?(this.toggleNewSearchBtn(!0),this.toggleSearchBtn()):(this.toggleSearchBtn(!0),this.toggleNewSearchBtn()),this.toggleActiveBorder(!0),this.toggleFilterBtn(),this.toggleResultsBtn()):(this.resultsHolder.classList.remove(activeClass),this.toggleSearchBtn(),this.toggleNewSearchBtn())},toggleSearchView(show=!1){const activeClass=this.baseStr+"-location-search--active";this.searchHolder||(this.searchHolder=this.element.querySelector(this.el+"-location-search")),show?(this.currentView="search",this.content.style.top="",this.content.style.overflow="",this.searchHolder.classList.add(activeClass),this.toggleActiveBorder(),this.toggleFilterBtn(),this.toggleInnerFill(),PubSub.publish("dealer.dealer-list-clear-toogle")):this.searchHolder.classList.remove(activeClass)},toggleListView(e,data){const{top,overflow,paginationH}=data;this.content.style.top=top,this.content.style.overflow=overflow,this.paginationH=paginationH},toggleResultsBtn(show=!1){const activeClass=this.baseStr+"__top-nav-back-results--active";show?this.backResultsBtn.classList.add(activeClass):this.backResultsBtn.classList.remove(activeClass)},toggleSearchBtn(show=!1){const activeClass=this.baseStr+"__top-nav-back-search--active";show?this.backSearchBtn.classList.add(activeClass):this.backSearchBtn.classList.remove(activeClass)},toggleFilterBtn(show=!1){const activeClass=this.baseStr+"__filter--show";show?this.filterBtn.classList.add(activeClass):this.filterBtn.classList.remove(activeClass)},toggleNewSearchBtn(show=!1){const activeClass=this.baseStr+"__top-nav-new-search--active";show?this.newSearchBtn.classList.add(activeClass):this.newSearchBtn.classList.remove(activeClass)},toggleDealerDetailMobile(e,show=!1){const contentActiveClass=this.baseStr+"__content-holder--detail-mobile",mapClass="google-map--detail-mobile";show?(this.currentView="dealer-detail-mobile",this.content.classList.add(contentActiveClass),this.mapHolder.classList.add(mapClass)):(this.content.classList.remove(contentActiveClass),this.mapHolder.classList.remove(mapClass))},toggleActiveBorder(show=!1){const activeClass=this.baseStr+"__top-nav--active-border",activeBtn="globalnav-map-popup__close-btn-holder--active";this.topNav||(this.topNav=this.element.querySelector(this.el+"__top-nav")),show?(this.topNav.classList.add(activeClass),this.closeBtn.parentNode.classList.add(activeBtn)):(this.topNav.classList.remove(activeClass),this.closeBtn.parentNode.classList.remove(activeBtn))},hideResults(e,data){(null==data||1==data)&&(this.toggleResultsView(),this.toggleFilterBtn(),this.toggleDealerDetailMobile(null),this.toggleSearchView(!0),PubSub.publish("dealermap.map-reset"),PubSub.publish("dealer.pagination-hide"),PubSub.publish("map.remove-trap-focus","result"),PubSub.publish("map.remove-trap-focus","detail"),PubSub.publish("map.set-trap-focus","search"))},changeBackBtn(){"singleDealer"!=this.currentSearch&&(this.toggleFilterBtn(),this.toggleSearchBtn(),this.toggleNewSearchBtn(),this.toggleResultsBtn(!0))},noResults(e,status){status&&this.isPhone?this.mapHolder.classList.add("google-map--no-results"):this.mapHolder.classList.remove("google-map--no-results")},resizeEvt(e,resizeObj){this.isPhone&&(null==resizeObj?void 0:resizeObj.width)>this.maxSize?(this.isPhone=!1,this.toggleDealerDetailMobile(null,!1)):!this.isPhone&&(null==resizeObj?void 0:resizeObj.width)<=this.maxSize&&(this.isPhone=!0,"dealer-detail-mobile"===this.currentView&&this.toggleDealerDetailMobile(null,!0)),this.getViewportHeightMobile(),this.getResizeTop(),this.resetEllipse()},getResizeTop(){if(_breakpoints.default.isMobile()&&this.isIPHONE){const viewportHeight=getComputedStyle(document.documentElement).getPropertyValue("--viewportHeight")||"100vh";this.content.style.top=`calc(${viewportHeight} - ${this.paginationH}px)`}}});exports.default=_default,module.exports=exports.default},19:function(module,exports,__webpack_require__){module.exports=__webpack_require__("./frontend_src/components/dealer-map/js/dealer-map.js")}});
//# sourceMappingURL=/etc/designs/bmwusa/bmwusa-clientlibs/bmwusa-sourcemaps/bmwusa-dealer-map-203902800b3faaf5f071.js.map