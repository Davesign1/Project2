/*!
 *  BMWUSA 
 *  Name: filterable-list-view 
 * 
 */!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],executeModules=data[2],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()();return deferredModules.push.apply(deferredModules,executeModules||[]),checkDeferredModules()}function checkDeferredModules(){for(var result,i=0;i<deferredModules.length;i++){for(var deferredModule=deferredModules[i],fulfilled=!0,j=1;j<deferredModule.length;j++){var depId=deferredModule[j];0!==installedChunks[depId]&&(fulfilled=!1)}fulfilled&&(deferredModules.splice(i--,1),result=__webpack_require__(__webpack_require__.s=deferredModule[0]))}return result}var installedModules={},installedChunks={35:0},deferredModules=[];function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/etc/designs/bmwusa/bmwusa-clientlibs/";var jsonpArray=window.webpackJsonp=window.webpackJsonp||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push([30,0]),checkDeferredModules()}({"./frontend_src/components/filterable-list-view/js/filterable-list-view.js":function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(exports,"__esModule",{value:!0}),exports.FilterableListView=void 0;var _utility$Breakpoints$,_component=__webpack_require__("./frontend_src/bmwlib/component.js"),_tooltips=_interopRequireDefault(__webpack_require__("./frontend_src/components/tooltips/js/tooltips.js")),_dealer=_interopRequireDefault(__webpack_require__("./frontend_src/components/filterable-list-view/js/templates/dealer.js")),_dealerInfo=__webpack_require__("./frontend_src/bmwlib/api-services/dealer-info.js"),_parents=_interopRequireDefault(__webpack_require__("./frontend_src/bmwlib/dom/parents.js"));const FilterableListView=new _component.Component({el:".filterable-list-view",name:"filterable-list-view Component",events:{},subscriptions:{"window.resizeEnd":"resizeEvt","dealermap.search-results":"initList","dealermap.list-update":"mapMarkerSelectedHandler","dealermap.dealer-view":"dealerViewSetup","dealer.search-results-list":"restartListView","dealer.search-results-pagination":"paginationEvt","filterview.filter":"applyFilter","dealer.dealer-list-clear-toogle":"clearResultsToggleState","dealer.list-reset":"resetPagination","filter.reset-list-view":"resetFilterView",dealerUpdate:"toggleDealershipState"},baseStr:"filterable-list-view",maxSize:_component.utility.Breakpoints.getValue("sm","max"),isPhone:"sm"===(null===(_utility$Breakpoints$=_component.utility.Breakpoints.current())||void 0===_utility$Breakpoints$?void 0:_utility$Breakpoints$.breakpoint),payload:{},pageSize:20,baseFilter:["1","2","6","7"],currentFilter:null,currentPage:0,currentItem:{},currentView:"list",totalPages:0,collection:[],fullCollection:[],allResults:[],showingResults:!0,filteredStatus:{hasFilter:!1,isFiltered:!1,filterId:0},mouseTimeout:null,mapContainer:document.querySelector(".dealer-map__outter-shell"),beforeInit(){this.initList=this.initList.bind(this),this.clearFilterClickEvt=this.clearFilterClickEvt.bind(this),this.listItemClickEvt=this.listItemClickEvt.bind(this),this.primaryDealerHandler=this.primaryDealerHandler.bind(this),this.listItemPrimaryClick=this.listItemPrimaryClick.bind(this),this.listItemMouseover=this.listItemMouseover.bind(this),this.listItemMouseout=this.listItemMouseout.bind(this),this.setPrimaryDealership=this.setPrimaryDealership.bind(this),this.toggleResultsList=this.toggleResultsList.bind(this),this.applyFilter=this.applyFilter.bind(this),this.detailViewClickEvt=this.detailViewClickEvt.bind(this),this.itemList=this.element.querySelector(this.el+"__list"),this.itemListElement=this.element.querySelector(this.el+"__dealer-list"),this.detailView=this.element.querySelector(this.el+"__dealer-details"),this.noResults=this.element.querySelector(this.el+"__no-results"),this.noResults&&(this.noResultsTitle=this.noResults.querySelector(".filterable-list-view__no-results--content"),this.noResultsMessage=this.noResults.querySelector("p")),this.mapToggle=this.element.querySelector(this.el+"__map-toggle"),this.content=(0,_parents.default)(this.element,".dealer-map__outter-shell"),this.pagination=document.querySelector(".dealer-map-pagination"),this.mapViewButton=this.element.querySelector(".filterable-list-view__map-hide"),this.resultViewButton=this.element.querySelector(".filterable-list-view__map-show"),this.mapToggle.addEventListener("click",this.toggleResultsList),this.mapToggle.addEventListener("keyup",e=>{"Enter"==e.key&&this.toggleResultsList}),this.itemListElement.addEventListener("click",this.listItemClickEvt),this.itemListElement.addEventListener("keyup",e=>{"Enter"==e.key&&this.listItemClickEvt(e)}),this.detailView.addEventListener("click",this.detailViewClickEvt)},init(){},updateCollection(data,isNavigation=!1){var _this$collection;_dealerInfo.DealerInfoApi.setDealerList(data),_dealerInfo.DealerInfoApi.setMaco(data.Maco),this.collection=_dealerInfo.DealerInfoApi.getDealerList();const collectionLength=null===(_this$collection=this.collection)||void 0===_this$collection?void 0:_this$collection.length;if(isNavigation||(this.currentPage=0),collectionLength>this.pageSize){const hasRemainder=collectionLength%this.pageSize,total=Math.floor(collectionLength/this.pageSize);this.totalPages=0==hasRemainder?total-1:total}else this.totalPages=0},initList(e,data){const{Results,Maco}=data;let outOfRange=!1;var _this$fullCollection;if(this.payload=data,this.fullCollection=Results,this.allResults=Results,this.collectionMaco=Maco,"singleDealer"==(null==data?void 0:data.currentSearch))this.collection=this.fullCollection,0<this.fullCollection.length&&_dealerInfo.DealerInfoApi.getMacoDataApi(_component.utility.CleanZip(this.fullCollection[0].ZipCode)).then(res=>{this.collectionMaco=res,this.showDetail(null,this.fullCollection[0].Id,!1)}).catch(err=>{console.error(err)});else if(0<this.fullCollection.length&&_dealerInfo.DealerInfoApi.getMacoDataApi(_component.utility.CleanZip(this.fullCollection[0].ZipCode)).then(res=>{this.collectionMaco=res}).catch(err=>{console.error(err)}),0<(null===(_this$fullCollection=this.fullCollection)||void 0===_this$fullCollection?void 0:_this$fullCollection.length)&&0<(null==Results?void 0:Results.length)){var _this$fullCollection2;if(1==(null===(_this$fullCollection2=this.fullCollection)||void 0===_this$fullCollection2?void 0:_this$fullCollection2.length)){const tempDealership=this.fullCollection[0];tempDealership.Id||(tempDealership.Id="1",this.fullCollection[0]=tempDealership)}if(outOfRange=!!this.fullCollection[0]&&100<this.fullCollection[0].Distance,this.currentItem=_dealerInfo.DealerInfoApi.getDealer(),outOfRange){var _auxCollection;let auxCollection=this.allResults,cnt=0;auxCollection=this.allResults.filter(elem=>{if(-1!=elem.Filters.indexOf(this.filteredStatus.filterId))return elem.Id=cnt,cnt++,elem}),auxCollection=0<(null===(_auxCollection=auxCollection)||void 0===_auxCollection?void 0:_auxCollection.length)?auxCollection.slice(0,1):this.allResults.slice(0,1),this.fullCollection=auxCollection}this.updateCollection(this.fullCollection),this.setupList(outOfRange)}else{var _this$fullCollection3;0<(null===(_this$fullCollection3=this.fullCollection)||void 0===_this$fullCollection3?void 0:_this$fullCollection3.length)?outOfRange=!!this.fullCollection[0]&&100<this.fullCollection[0].Distance:(outOfRange=!!this.collection[0]&&100<this.collection[0].Distance,PubSub.publish("dealermap.map-reset",!0)),this.setupList(outOfRange)}},applyFilter(e,data){var _this$fullCollection4;const{filterId}=data;if(0<(null===(_this$fullCollection4=this.fullCollection)||void 0===_this$fullCollection4?void 0:_this$fullCollection4.length)){let baseCollection=this.fullCollection,auxCollection=this.allResults,cnt=1;1<=parseInt(filterId)?(this.filteredStatus.hasFilter=!0,this.filteredStatus.isFiltered=!0,this.filteredStatus.filterId=filterId,baseCollection=baseCollection.filter(elem=>{if(-1!=elem.Filters.indexOf(filterId)&&100>=elem.Distance)return elem.Id=cnt,cnt++,elem})):(this.resetFilterView(),baseCollection=baseCollection.filter(elem=>{if(100>=elem.Distance)return elem.Id=cnt,cnt++,elem})),0>=baseCollection.length?(cnt=0,auxCollection=this.allResults.filter(elem=>{if(-1!=elem.Filters.indexOf(filterId))return elem.Id=cnt,cnt++,elem}),auxCollection=0<auxCollection.length?auxCollection.slice(0,1):this.allResults.slice(0,1),this.updateCollection(auxCollection),this.noResultsDisplay=!0,this.setupList(!0)):(this.updateCollection(baseCollection),this.setupList())}},resetFilterView(){this.filteredStatus.isFiltered&&(this.removeFilterItem(),this.filteredStatus.hasFilter=!1,this.filteredStatus.isFiltered=!1,this.filteredStatus.filterId=0)},showFilterItem(){const container=this.isPhone?this.itemListElement:this.itemList,firstNode=container.children[0],currentFilterItem=_dealer.default.filter(this.filteredStatus,this.baseStr,this.isPhone);currentFilterItem.querySelector("button").addEventListener("click",this.clearFilterClickEvt),firstNode&&firstNode.classList.contains(this.baseStr+"__filter-info")&&this.removeFilterItem(),container.insertBefore(currentFilterItem,container.firstChild)},removeFilterItem(){const container=this.isPhone?this.itemListElement:this.itemList,element=container.children[0];element.removeEventListener("click",this.clearFilterClickEvt),container.removeChild(element)},restartListView(){this.resetFilterView(),this.setupList(),100<this.collection[0].Distance&&(this.noResultsDisplay=!0),this.showList()},addListListeners(){document.querySelectorAll(".filterable-list-view__dealer").forEach(elem=>{elem.addEventListener("mouseover",this.listItemMouseover),elem.addEventListener("mouseout",this.listItemMouseout)})},removeListListeners(){document.querySelectorAll(".filterable-list-view__dealer").forEach(elem=>{elem.removeEventListener("mouseover",this.listItemMouseover),elem.removeEventListener("mouseout",this.listItemMouseout)})},addListPrimaryListeners(){document.querySelectorAll(".filterable-list-view__primary-dealership").forEach(elem=>elem.addEventListener("click",this.primaryDealerHandler))},setupList(outSide100=!1,isNavigation=!1){let mapItems={center:this.payload.Center,currentSearch:this.payload.currentSearch,points:[]};mapItems.center&&mapItems.currentSearch?localStorage.setItem("centralPoint",JSON.stringify(mapItems)):mapItems=this.getCenterDataFromStorage(mapItems);const mIndex=this.currentPage*this.pageSize;let eIndex=(this.currentPage+1)*this.pageSize-1,currentElementIndex=1;if(this.removeListListeners(),0==this.filteredStatus.isFiltered&&0==this.filteredStatus.hasFilter){let filteredCollection=this.collection.map(elem=>{let matching=!1;if(elem.Filters.forEach(element=>{this.baseFilter.includes(element)&&(matching=!0)}),matching&&100>=elem.Distance)return elem.Id=currentElementIndex,currentElementIndex++,elem});filteredCollection=filteredCollection.filter(elem=>null!=elem),0<filteredCollection.length&&this.updateCollection(filteredCollection,isNavigation)}else if(this.filteredStatus.hasFilter){const filteredCollection=this.collection.map(elem=>{if(elem.Filters.includes(this.filteredStatus.filterId))return elem.Id=currentElementIndex,currentElementIndex++,elem});this.updateCollection(filteredCollection.filter(elem=>null!=elem),isNavigation)}eIndex>this.collection.length&&(eIndex=this.collection.length-1);const theList=this.collection.slice(mIndex,eIndex+1).map((elem,index)=>{if(elem)return mapItems.points.push(this.generateMapCoordinate(elem,index+mIndex)),_dealer.default.getListItem(elem,this.baseStr)}).join("");if(PubSub.publish("dealermap.map-update",mapItems),this.itemListElement.innerHTML=theList,_tooltips.default.buildTooltips(),this.currentPage,this.pageSize,outSide100||0==mapItems.points)this.showPagination=!1,this.noResultsDisplay=!0,this.showList(),this.itemListElement.parentNode.classList.add(this.baseStr+"__list-holder--bottom-align");else{this.showPagination=!0,this.noResultsDisplay=!1,this.itemListElement.parentNode.classList.remove(this.baseStr+"__list-holder--bottom-align"),PubSub.publish("dealer.pagination-num",{min:mIndex+1,max:eIndex+1,total:this.totalPages,results:this.collection.length});const isActive=this.element.querySelector(this.el+"__noresut");isActive&&isActive.parentNode.removeChild(isActive),this.showList()}},getCenterDataFromStorage(mapItems){let centralPoint=null;return mapItems.center||mapItems.currentSearch||(centralPoint=JSON.parse(localStorage.getItem("centralPoint")),centralPoint&&(mapItems.center=centralPoint.center,mapItems.currentSearch=centralPoint.currentSearch)),mapItems},detailViewClickEvt(e){const elem=e.target;elem.matches(this.el+"__save-dealer")&&(elem.classList.contains("primary_dealership")?_dealerInfo.DealerInfoApi.removePrimaryDealer(_dealerInfo.DealerInfoApi.getDealer().UniqueID):(this.setPrimaryDealership(elem.dataset.id,elem),_component.utility.cookies.set("user_zipcode",this.currentItem.ZipCode,null,"/")))},getDealerById(dealerId){const id=parseInt(dealerId);return this.collection&&0===this.collection.length&&_dealerInfo.DealerInfoApi.getDealerList().forEach(dealer=>this.collection.push(dealer)),this.collection.find(dealer=>dealer.Id===id)},setLocalDealership(dealerId){this.currentItem=this.getDealerById(dealerId),_dealerInfo.DealerInfoApi.setDealerList(this.collection),_dealerInfo.DealerInfoApi.setLocalDealer(this.currentItem.UniqueID,this.collectionMaco)},setPrimaryDealership(dealerId){this.currentItem=this.getDealerById(dealerId),_dealerInfo.DealerInfoApi.setDealerList(this.collection),_dealerInfo.DealerInfoApi.setPrimaryDealer(this.currentItem.UniqueID,this.collectionMaco),PubSub.publish("nav.dealerSet",this.currentItem),PubSub.publish("dealermap.primarydealership-selected"),PubSub.publish("dtmPrimaryDealershipSelected",{dealer:this.currentItem,maco:this.collectionMaco}),PubSub.publish("dealermap.dealer-primary-toggle",{primary:!0,dealer:this.currentItem,maco:this.collectionMaco,payload:this.collection})},toggleDealershipState(e,dealerInfo){"list"===this.currentView?this.togglePrimaryDealershipListView(dealerInfo):"detail"===this.currentView&&this.togglePrimaryDealershipDetailView(dealerInfo)},togglePrimaryDealershipListView(dealerInfo){const currentSelectedButton=this.itemListElement.querySelector(".primary"),newSelectedButton=this.itemListElement.querySelector(`${this.el}__primary-dealership[data-id='${dealerInfo.dealer.Id}']`);let tooltip;null!=currentSelectedButton&&(currentSelectedButton.classList.remove("primary"),tooltip=currentSelectedButton.querySelector("span"),tooltip&&tooltip.setAttribute("title",tooltip.dataset.titleadd)),currentSelectedButton!=newSelectedButton&&(newSelectedButton.classList.add("primary"),tooltip=newSelectedButton.querySelector("span"),tooltip&&tooltip.setAttribute("title",tooltip.dataset.titleremove),PubSub.publish("dealermap.primarydealership-selected"))},togglePrimaryDealershipDetailView(dealerInfo){const savePrimaryButton=document.querySelector(this.el+"__save-dealer"),savePrimaryLabel=savePrimaryButton.querySelector("span.dealerCopy");dealerInfo.dealer.IsPrimary?(savePrimaryButton.classList.add("primary_dealership"),savePrimaryLabel.innerHTML="My Primary Dealer",PubSub.publish("dealermap.primarydealership-selected")):savePrimaryButton.classList.contains("primary_dealership")&&(savePrimaryButton.classList.remove("primary_dealership"),savePrimaryLabel.innerHTML="Save as Primary Dealer")},populateDetailView(){if(""===this.collectionMaco.Code)_dealerInfo.DealerInfoApi.getMacoDataApi(_component.utility.CleanZip(this.currentItem.ZipCode)).then(res=>{this.collectionMaco=res;const detailData=_dealer.default.getDetailItem(this.currentItem,this.collectionMaco,this.baseStr);this.detailView.innerHTML=detailData}).catch(err=>{console.error(err)});else{const detailData=_dealer.default.getDetailItem(this.currentItem,this.collectionMaco,this.baseStr);this.detailView.innerHTML=detailData}},generateMapCoordinate:(item,index)=>({lat:item.LonLat.Lat,lng:item.LonLat.Lon,type:1==item.IsPrimary?"primary":"default",img:item.GoogleMapsUrl,id:item.Id,index,distance:item.Distance}),mapMarkerSelectedHandler(e,dealerId){this.setLocalDealership(dealerId),this.showDetail(e,dealerId)},dealerViewSetup(e,data){const{Maco,payload,dealer}=data;this.fullCollection=payload,this.collectionMaco=Maco,this.showDetail(null,dealer[0].Id,!0)},showDetail(e,id,newSearch=!1){this.currentView="detail",this.currentItem=this.getDealerById(id);const marker=this.generateMapCoordinate(this.currentItem),mapItems={center:this.payload.Center,points:[marker]};PubSub.publishSync("mapcomponent.map-update-detail",mapItems),this.populateDetailView(),this.itemList.classList.remove(this.baseStr+"__dealers--active"),this.detailView.classList.add(this.baseStr+"__dealer-details--active"),this.noResults.classList.remove(this.baseStr+"__no-results--active"),this.isPhone&&(this.toggleDisplayMapIcon(),this.toggleDisplayMapTabIndex(!0),PubSub.publish("dealer.detail-veiw-mobile",!0)),newSearch?PubSub.publish("dealer.detail-new-search"):PubSub.publish("dealer.detail-veiw"),PubSub.publish("dealer.pagination-hide"),PubSub.publish("map.set-trap-focus","detail")},showList(){var _this$collection2;this.currentView="list",this.itemListElement.classList.remove(this.baseStr+"-list-items--hide"),this.itemList.classList.add(this.baseStr+"__dealers--active"),this.detailView.classList.remove(this.baseStr+"__dealer-details--active"),this.isPhone?(this.toggleDisplayMapIcon(!0),this.toggleDisplayMapTabIndex(!1),PubSub.publish("dealer.detail-veiw-mobile",!1)):this.addListListeners(),this.addListPrimaryListeners();this.filteredStatus.isFiltered;const mapItems={center:this.payload.Center,currentSearch:this.payload.currentSearch,points:[]};0<(null===(_this$collection2=this.collection)||void 0===_this$collection2?void 0:_this$collection2.length)&&this.collection.forEach((item,index)=>{item&&mapItems.points.push(this.generateMapCoordinate(item,index))}),this.noResultsDisplay?(this.noResultsTitle.classList.add(this.baseStr+"__title--active"),this.noResults.classList.add(this.baseStr+"__no-results--active"),PubSub.publish("dealermap.no-results",mapItems),PubSub.publish("dealer.pagination-hide")):(this.noResultsTitle.classList.remove(this.baseStr+"__title--active"),this.noResults.classList.remove(this.baseStr+"__no-results--active"),PubSub.publish("dealermap.no-results",!1)),this.filteredStatus.isFiltered&&0!=this.filteredStatus.filterId&&this.showFilterItem(),this.showPagination&&PubSub.publish("dealer.pagination-display"),PubSub.publish("map.set-trap-focus","result")},showNoResults(){this.showingResults=!1,this.itemListElement.classList.add(this.baseStr+"-list-items--hide"),this.noResultsTitle.classList.remove(this.baseStr+"__title--active"),this.detailView.classList.remove(this.baseStr+"__dealer-details--active"),this.noResults.classList.add(this.baseStr+"__no-results--active")},resetPagination(){this.currentPage=0,PubSub.publish("dealer.pagination-disabled","prev"),0<this.totalPages&&PubSub.publish("dealer.pagination-enable","next")},paginationEvt(e,dir){"prev"===dir&&0<this.currentPage?(this.currentPage--,this.element.querySelector(".filterable-list-view__dealer > div").focus(),PubSub.publish("dealer.pagination-clear-disabled"),this.setupList(!1,!0),0===this.currentPage&&PubSub.publish("dealer.pagination-disabled","prev")):"prev"==dir&&0>=this.currentPage&&PubSub.publish("dealer.pagination-disabled","prev"),"next"===dir&&this.currentPage<this.totalPages?(this.currentPage++,this.element.querySelector(".filterable-list-view__dealer > div").focus(),PubSub.publish("dealer.pagination-clear-disabled"),this.setupList(!1,!0),this.currentPage===this.totalPages&&PubSub.publish("dealer.pagination-disabled","next")):"next"==dir&&this.currentPage>=this.totalPages&&PubSub.publish("dealer.pagination-disabled","next "),PubSub.publish("map.set-trap-focus")},listItemClickEvt(e){const elem=e.target.matches(this.el+"__icon")?e.target.parentNode:e.target;let dealerId;elem.matches(this.el+"__dealer")&&(dealerId=elem.children[0].dataset.id,this.setLocalDealership(dealerId),this.showDetail(null,dealerId),document.querySelector(".filterable-list-view__detail-header a").focus()),e.target.matches(this.el+"__item")&&(dealerId=e.target.dataset.id,this.setLocalDealership(dealerId),this.showDetail(null,dealerId),document.querySelector(".filterable-list-view__detail-header a").focus())},primaryDealerHandler(e){const toggle=e.target.classList.contains("primary")?null:e.target.dataset.id;e.target.classList.contains("primary")?_dealerInfo.DealerInfoApi.removePrimaryDealer(this.getDealerById(e.target.dataset.id).UniqueID):this.listItemPrimaryClick(toggle,e.target.dataset.id)},clearFilterClickEvt(){this.filteredStatus.hasFilter=!1,this.filteredStatus.isFiltered=!1,this.filteredStatus.filterId=0,this.applyFilter(null,{filterId:0}),this.removeFilterItem(),PubSub.publish("filterlist.clear-filter")},listItemPrimaryClick(toggle){this.setPrimaryDealership(toggle)},listItemMouseover(e){clearTimeout(this.mouseTimeout),this.mouseTimeout=setTimeout(()=>{const elem=e.target.querySelector(".filterable-list-view__item");if(elem){const id=elem.dataset.id;PubSub.publish("mapcomponent.marker-hover",id)}},100)},listItemMouseout(e){clearTimeout(this.mouseTimeout),this.mouseTimeout=setTimeout(()=>{e.target.querySelector(".filterable-list-view__item")&&PubSub.publish("mapcomponent.marker-hover",-1)},100)},toggleDisplayMapIcon(show=!1){const activeStr=this.baseStr+"__map-toggle--active-display";show&&this.mapToggle?this.mapToggle.classList.add(activeStr):(this.clearResultsToggleState(null),PubSub.publish("dealer.toggleListView",{top:"",overflow:""}),this.mapToggle&&this.mapToggle.classList.remove(activeStr))},toggleDisplayMapTabIndex(reset){reset?(this.mapViewButton.tabIndex=-1,this.resultViewButton.tabIndex=-1,this.mapViewButton.removeAttribute("tab-index"),this.resultViewButton.removeAttribute("tab-index")):this.showingResults?(this.mapViewButton.tabIndex=0,this.resultViewButton.tabIndex=-1,this.resultViewButton.removeAttribute("tab-index")):(this.mapViewButton.tabIndex=-1,this.resultViewButton.tabIndex=0,this.mapViewButton.removeAttribute("tab-index"))},toggleResultsList(e){const target=e.currentTarget,h=target.offsetHeight,paginationH=this.showPagination?this.pagination.offsetHeight:0,viewportHeight=getComputedStyle(document.documentElement).getPropertyValue("--viewportHeight")||"100vh";PubSub.publish("dealer.toggleListView",{top:this.showingResults?`calc(${viewportHeight} - ${h+paginationH}px)`:"",overflow:this.showingResults?"hidden":"",paginationH:h+paginationH}),target.classList.toggle(this.baseStr+"__map-toggle--active"),this.showingResults=!this.showingResults,this.toggleDisplayMapTabIndex(!1),PubSub.publish("map.set-trap-focus","result")},clearResultsToggleState(){this.mapToggle&&this.mapToggle.classList.remove(this.baseStr+"__map-toggle--active"),this.showingResults=!0},resizeEvt(e,resizeObj){this.isPhone&&(null==resizeObj?void 0:resizeObj.width)>this.maxSize?(this.isPhone=!1,this.toggleDisplayMapIcon()):!this.isPhone&&(null==resizeObj?void 0:resizeObj.width)<=this.maxSize&&(this.isPhone=!0,"detail"===this.currentView?this.addListListeners():this.toggleDisplayMapIcon(!0))}});exports.FilterableListView=FilterableListView},"./frontend_src/components/filterable-list-view/js/templates/dealer.js":function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _serviceMap=_interopRequireDefault(__webpack_require__("./frontend_src/bmwlib/data/serviceMap.js")),_component=__webpack_require__("./frontend_src/bmwlib/component.js");var _default={servicesMap:new Map(_serviceMap.default),getListItem(data,baseStr){const{Distance,IsPrimary,City,Address,Name,State,ZipCode,Id,Filters}=data,primary=IsPrimary?"primary":"",primaryTitle=IsPrimary?"Remove primary dealer":"Save as primary dealer",dist=Distance?Distance+" mi  &#8226;":"",mCertCenter=0<Filters.indexOf("5")?`<br><span class="${baseStr}__m-center"><img alt="M Performance Logo" src="/content/dam/bmwusa/common/globalnav/BMW-logo-M_Performance_2.png"> Certified Center</span>`:"";return`<li class="${baseStr}__dealer">\n        <div class="${baseStr}__item" data-id="${Id}" title="${Id} - ${Name}. ${Address}, ${City}." role="button" tabindex="0">\n          <div class="${baseStr}__number">${Id}</div>\n          <div>\n            <div class="${baseStr}__dealer-name">${Name}</div>\n            <div class="${baseStr}__dealer-location">\n              ${dist} ${Address}<br>\n              ${City}, ${State} ${_component.utility.CleanZip(ZipCode)}\n              ${mCertCenter}\n            </div>\n          </div>\n        </div>\n        <button class="${baseStr}__primary-dealership ${primary} bmw-tooltip" data-interactive="false" data-id="${Id}" data-theme="bmw-light-minimal" data-icon="icon-map-star" data-animateFill="false" data-arrow="true" aria-label="${primaryTitle}" data-titleadd="Save as primary dealer" data-titleremove="Remove primary dealer" data-position="bottom" data-tippy-offset="0,10" data-tippy-placement="bottom" data-size="small" data-dynamicTitle="true">\n          <span class="${baseStr}__icon">\n            <svg aria-label="hidden">\n              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-map-star">\n            </use></svg>\n          </span>\n        </button>\n      </li>`},getVisitorURL:url=>window.BMWVisitor?BMWVisitor.getVisitorURL(url):url,filter(filterType,baseStr,isPhone=!1){const{filterId}=filterType;if(0!==filterId){const elementType=isPhone?"li":"div",element=document.createElement(elementType),text=this.servicesMap.get(filterId);return element.classList.add(baseStr+"__filter-info"),element.innerHTML=`Showing: "${text}" <button class="${baseStr}__clear-filter">Clear</button>`,element}return""},formatHours:(start,end)=>`${start.split(":")[0].replace(/^0+/,"")} ${start.split(" ")[1].toLowerCase()} - ${end.split(":")[0].replace(/^0+/,"")} ${end.split(" ")[1].toLowerCase()}`,getHours(data,baseStr){const{Hours}=data;let hoursTemp="",hours="";return"N"===Hours.mon_close_ind&&(hours+=`<dd>\n        <span class="${baseStr}__days">Mon-Thu</span>\n        <span class="${baseStr}__time-frame">${this.formatHours(Hours.mon_start_time,Hours.mon_end_time)}</span>\n      </dd>`),"N"===Hours.fri_close_ind&&(hours+=`<dd>\n        <span class="${baseStr}__days">Fri</span>\n        <span class="${baseStr}__time-frame">${this.formatHours(Hours.fri_start_time,Hours.fri_end_time)}</span>\n      </dd>`),"N"===Hours.sat_close_ind&&(hours+=`<dd>\n        <span class="${baseStr}__days">Sat</span>\n        <span class="${baseStr}__time-frame">${this.formatHours(Hours.sat_start_time,Hours.sat_end_time)}</span>\n      </dd>`),"N"===Hours.sun_close_ind&&(hours+=`<dd>\n        <span class="${baseStr}__days">Sun</span>\n        <span class="${baseStr}__time-frame">${this.formatHours(Hours.sun_start_time,Hours.sun_end_time)}</span>\n      </dd>`),hoursTemp+=`\n      <div class="${baseStr}__dealer-info ${baseStr}__hours">\n        <dl>\n          <dt>\n            <svg>\n              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-t1-dealer-locator-details-clock">\n            </svg> Hours of operation\n          </dt>\n          ${hours}\n        </dl>\n      </div>`,hoursTemp},getHeader(data,maco,baseStr){const{IsPrimary,Id,Name}=data,{Url,Display}=maco,_url=this.getVisitorURL(Url);let primaryTitle,btnCopy,btnClass="";return IsPrimary?(primaryTitle="<span>Primary BMW Center</span> "+Name,btnClass="primary_dealership",btnCopy="My Primary Dealer"):(primaryTitle=Name,btnCopy="Save as Primary Dealer"),`<header class="${baseStr}__detail-header">\n        <div class="${baseStr}__detail-header--content">\n          ${primaryTitle}\n        </div>\n        <div class="${baseStr}__detail-header--link">\n          <span class="icon">\n            <svg aria-label="hidden">\n              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-bold-arrow">\n            </svg>\n          </span>\n          <a data-analytics-on-tier-exit="" data-analytics-tier-2='${JSON.stringify(maco)}' href="${_url}">${Display}</a>\n        </div>\n        <button\n          data-id="${Id}"\n          class="${baseStr}__save-dealer ${btnClass}">\n          <span class="icon">\n            <svg aria-label="hidden">\n              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-map-star">\n            </svg>\n          </span>\n          <span class="dealerCopy">${btnCopy}</span>\n        </button>\n      </header>`},getPhone(data,baseStr){const{FormattedPhone}=data;let phoneTemp="";return 0<FormattedPhone.length&&(phoneTemp+=`<div class="${baseStr}__phone-number ${baseStr}__dealer-info">\n          <svg>\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-phone"></use>\n          </svg>\n          <a href="tel:${FormattedPhone}">${FormattedPhone}</a>\n        </div>`),phoneTemp},getUrl(data,baseStr){const{Url,Name}=data;let urlTemp="";if(0<data.Url.length){urlTemp+=`<div class="${baseStr}__website ${baseStr}__dealer-info">\n          <svg>\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-website"></use>\n          </svg>\n          <a data-analytics-on-tier-exit="" data-analytics-tier-3='${JSON.stringify(data).replace(/'/g,"&apos;")}' href="${this.getVisitorURL(Url)}" target="_blank" title="${Name}">\n            ${(url=>{const format=url.split(".");return 3===format.length?format.slice(1,3).join("."):url.substr(url.indexOf("://")+3)})(Url)}\n          </a>\n        </div>`}return urlTemp},getAddress(data,baseStr){const{Address,City,State,ZipCode}=data,formattedAddress=`${Address}, ${City}, ${State} ${_component.utility.CleanZip(ZipCode)}`;let addressTemp="",distanceTemp="";return data.Distance&&(distanceTemp=`<span class="${baseStr}__distance">\n          ${data.Distance} mi\n        </span>`),addressTemp+=`<div class="${baseStr}__location ${baseStr}__dealer-info">\n        <div class="${baseStr}__address">\n          <svg>\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-nav-marker-header"></use>\n          </svg>\n          <span>\n            ${formattedAddress}\n          </span>\n        </div>\n        ${distanceTemp}\n      </div>`,addressTemp},getServices(data,baseStr){const{Services}=data;let servicesTemp="";if(0<Services.length){return servicesTemp+=`\n          <div class="${baseStr}__services ${baseStr}__dealer-info">\n            <dl>\n              <dt>Services Offered</dt>\n              ${Services.map(service=>`<dd>${service}</dd>`).join("")}\n            </dl>\n          </div>`,servicesTemp}},getDetailItem(data,maco,baseStr){return`${this.getHeader(data,maco,baseStr)}\n            <div class="${baseStr}__dealer-business-info">\n              ${this.getHours(data,baseStr)}\n              ${this.getPhone(data,baseStr)}\n              ${this.getUrl(data,baseStr)}\n              ${this.getAddress(data,baseStr)}\n              ${this.getServices(data,baseStr)}\n            </div>`}};exports.default=_default,module.exports=exports.default},30:function(module,exports,__webpack_require__){module.exports=__webpack_require__("./frontend_src/components/filterable-list-view/js/filterable-list-view.js")}});
//# sourceMappingURL=/etc/designs/bmwusa/bmwusa-clientlibs/bmwusa-sourcemaps/bmwusa-filterable-list-view-203902800b3faaf5f071.js.map