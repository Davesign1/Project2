/*!
 *  BMWUSA 
 *  Name: globalnav-map-popup 
 * 
 */!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],executeModules=data[2],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()();return deferredModules.push.apply(deferredModules,executeModules||[]),checkDeferredModules()}function checkDeferredModules(){for(var result,i=0;i<deferredModules.length;i++){for(var deferredModule=deferredModules[i],fulfilled=!0,j=1;j<deferredModule.length;j++){var depId=deferredModule[j];0!==installedChunks[depId]&&(fulfilled=!1)}fulfilled&&(deferredModules.splice(i--,1),result=__webpack_require__(__webpack_require__.s=deferredModule[0]))}return result}var installedModules={},installedChunks={44:0},deferredModules=[];function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/etc/designs/bmwusa/bmwusa-clientlibs/";var jsonpArray=window.webpackJsonp=window.webpackJsonp||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push([39,0]),checkDeferredModules()}({"./frontend_src/components/globalnav-map-popup/js/globalnav-map-popup.js":function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _component=__webpack_require__("./frontend_src/bmwlib/component.js"),_adaUtils=_interopRequireDefault(__webpack_require__("./frontend_src/bmwlib/utility/ada-utils.js")),_dealerInfo=__webpack_require__("./frontend_src/bmwlib/api-services/dealer-info.js");var _default=new _component.Component({el:".globalnav-map-popup",name:"globalnav-map-popup Component",baseStr:"globalnav-map-popup",subscriptions:{"dealermap.popover-open":"openMap","dealermap.dealer-selected":"storeDealer","map.set-trap-focus":"setTrapFocus","map.remove-trap-focus":"removeTrapFocus","fill.clicked":"closeMap","map.close-map":"closeMap","window.resizeEnd":"resizeEvt",dealerUpdate:"storeDealer"},adaFocusableItems:[".google-map a"],adaSearchPageFocusableItems:[".dealer-map-location-search__input-holder input",".dealer-map-location-search__search-btn"],dynamicContent:[".globalnav-map-popup--active"],currentBreakpoint:960<=window.innerWidth?"desktop":"mobile",events:{"click .globalnav-map-popup":"closeMap"},beforeInit(){this.closeBtn=this.element.querySelector(this.el+"__close-btn"),this.body=document.body,this.closeMap=this.closeMap.bind(this),this.keyCheck=this.keyCheck.bind(this),this.openMap=this.openMap.bind(this),this.isExternalOpen=!1},init(){_component.$dom.qs(".globalnav")&&(_component.$dom.qs(".globalnav").dataset.mapsKey="AIzaSyCahsmc9ueMU-kn1Yp4E7sa0b7CLjIi6Xg"),this.closeBtn.addEventListener("click",this.closeMap),this.trapFocus,_adaUtils.default.restrictFocus({container:this.element})},openMap(e,isExternal){PubSub.publish("dealermap.render"),this.isExternalOpen=void 0!==isExternal,this.element.classList.add(this.baseStr+"--active"),window.addEventListener("keyup",this.keyCheck),"mobile"!==this.currentBreakpoint&&this.toggleFill(!1,!0),this.isExternalOpen||(this.body.classList.add("globalnav-primary__map--kill-scroll"),setTimeout(()=>{document.querySelector(".dealer-map__top-nav-new-search").focus()},500)),_adaUtils.default.restrictFocus({container:this.element,toggleOpen:!0}),_adaUtils.default.restrictFocus({container:_component.$dom.qs(".filterable-list-view__map-toggle",this.element)}),this.setTrapFocus(),PubSub.publish("dealer.open"),GlobalMessage("measure.dtm.track","dtmDealerLocatorModalOpen")},toggleFill(close=!1,open=!1){PubSub.publish("nav.toggleFill",{className:"globalnav-primary-fill--active-map",close,open})},closeMap(){this.element.classList.remove(this.baseStr+"--active"),this.toggleFill(!0),this.body.classList.remove("globalnav-primary__map--kill-scroll"),window.removeEventListener("keyup",this.keyCheck),PubSub.publish("dealer.list-reset"),PubSub.publish("filter.reset-list-view"),PubSub.publish("map.close-modal"),PubSub.publish("filter.toggleDisplay"),this.isExternalOpen||setTimeout(()=>{document.querySelectorAll(".globalnav-primary-location-bar__flex-holder button").forEach(button=>button.focus())},500),!_dealerInfo.DealerInfoApi.isDealerSet()&&_dealerInfo.DealerInfoApi.getDealerList()&&_dealerInfo.DealerInfoApi.setLocalDealer(_dealerInfo.DealerInfoApi.getDealerList()[0].UniqueID,_dealerInfo.DealerInfoApi.getMaco()),_adaUtils.default.restrictFocus({container:this.element,focusableItems:this.adaFocusableItems}),this.removeTrapFocus(),GlobalMessage("measure.dtm.track","dtmDealerLocatorModalClose")},storeDealer(e,dealer){this.selectedDealership=dealer},setTrapFocus(e,page){const mapContainer=_component.$dom.qs(".dealer-map__outter-shell",this.element);this.removeTrapFocus(),"search"===page&&_adaUtils.default.restrictFocus({container:_component.$dom.qs(".dealer-map-location-search",this.element),focusableItems:this.adaSearchPageFocusableItems}),"result"===page&&_adaUtils.default.restrictFocus({container:_component.$dom.qs(".dealer-map-location-search",this.element)}),"detail"===page&&(_adaUtils.default.restrictFocus({container:_component.$dom.qs(".filterable-list-view__dealer-list",this.element)}),_adaUtils.default.restrictFocus({container:_component.$dom.qs(".dealer-map-location-search",this.element)})),mapContainer&&(this.trapFocus=_adaUtils.default.trapFocus(mapContainer),this.trapFocus.addTrapFocus())},removeTrapFocus(e,page){const dealerList=_component.$dom.qs(".filterable-list-view__dealer-list",this.element);this.trapFocus&&this.trapFocus.removeTrapEventListener(),"result"===page&&(dealerList&&0<dealerList.childNodes.length&&(dealerList.innerHTML=""),_adaUtils.default.restrictFocus({container:_component.$dom.qs(".dealer-map-location-search",this.element),focusableItems:this.adaSearchPageFocusableItems})),"detail"===page&&_adaUtils.default.restrictFocus({container:_component.$dom.qs(".filterable-list-view__dealer-details",this.element)})},keyCheck(e){27===e.which&&this.closeMap()},isMapOpen(){this.element.classList.contains(this.baseStr+"--active")&&this.toggleFill(!1,!0)},resizeEvt(e,resizeObj){"desktop"===this.currentBreakpoint&&960>(null==resizeObj?void 0:resizeObj.width)?(this.currentBreakpoint="mobile",this.toggleFill(!0)):"mobile"===this.currentBreakpoint&&960<=(null==resizeObj?void 0:resizeObj.width)&&(this.currentBreakpoint="desktop",this.isMapOpen())}});exports.default=_default,module.exports=exports.default},39:function(module,exports,__webpack_require__){module.exports=__webpack_require__("./frontend_src/components/globalnav-map-popup/js/globalnav-map-popup.js")}});
//# sourceMappingURL=/etc/designs/bmwusa/bmwusa-clientlibs/bmwusa-sourcemaps/bmwusa-globalnav-map-popup-203902800b3faaf5f071.js.map